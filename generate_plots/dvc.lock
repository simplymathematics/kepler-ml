schema: '2.0'
stages:
  merge@mnist:
    cmd: python merge.py  --big_dir data/bit_depth/mnist --little_dir data/mnist --config
      ../conf/afr.yaml --data_file power.csv --output_folder mnist/ --output_file
      merged.csv
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: data/bit_depth/mnist/power.csv
      hash: md5
      md5: ed40bca679961759527ca94ca4cbd984
      size: 5421537
    - path: data/mnist/power.csv
      hash: md5
      md5: 6c84e8e91d81504e86db933bab0e9ae2
      size: 9968081
    params:
      ../conf/clean.yaml:
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
    outs:
    - path: mnist/merged.csv
      hash: md5
      md5: 8f227012f75f50d6f01745b54d2dc5a5
      size: 15408533
  clean@mnist:
    cmd: python -m deckard.layers.clean_data --i mnist/merged.csv --o mnist/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: mnist/merged.csv
      hash: md5
      md5: 8f227012f75f50d6f01745b54d2dc5a5
      size: 15408533
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: mnist/clean.csv
      hash: md5
      md5: 4dfbcdb8c5aa27976ec2811ea9c1fda6
      size: 9294911
  afr@mnist:
    cmd: python -m deckard.layers.afr --dataset mnist --data_file mnist/clean.csv
      --config_file "../conf/afr.yaml" --plots_folder mnist/ --target adv_failures
      --duration_col adv_fit_time
    deps:
    - path: ../conf/afr.yaml
      hash: md5
      md5: 061aa289da159a323139555e472391da
      size: 5666
    - path: mnist/clean.csv
      hash: md5
      md5: 4dfbcdb8c5aa27976ec2811ea9c1fda6
      size: 9294911
    outs:
    - path: mnist/aft_comparison.csv
      hash: md5
      md5: f6e0ce8c6d214014261fb52b1566ce1c
      size: 263
    - path: mnist/aft_comparison.tex
      hash: md5
      md5: 83287d600aa7abcda0314c23ffe7e49f
      size: 537
    - path: mnist/cox_aft.pdf
      hash: md5
      md5: eff5864d944e47a75e6159faf0f6ffd6
      size: 22979
    - path: mnist/cox_epochs_partial_effect.pdf
      hash: md5
      md5: ec0800c18ba08e14b4aea028d4ca831a
      size: 26648
    - path: mnist/log_logistic_aft.pdf
      hash: md5
      md5: fba2f37fb18cf40b99730bf3f53bb89f
      size: 22830
    - path: mnist/log_logistic_epochs_partial_effect.pdf
      hash: md5
      md5: 72be40c6e1c59a4a35ac6b94693b3b9a
      size: 24701
    - path: mnist/log_normal_aft.pdf
      hash: md5
      md5: 9d7d2a7eb9a56fd13a6279afca8c2ff3
      size: 23162
    - path: mnist/log_normal_epochs_partial_effect.pdf
      hash: md5
      md5: 584b057630df4af6b5d39ca04cfe3555
      size: 25406
    - path: mnist/weibull_aft.pdf
      hash: md5
      md5: 92d286a042b56fc898451bd5727acf30
      size: 22966
    - path: mnist/weibull_epochs_partial_effect.pdf
      hash: md5
      md5: df2ba7c9ba44850fc72220eebfa43eb1
      size: 24391
  merge@cifar:
    cmd: python merge.py  --big_dir data/bit_depth/cifar --little_dir data/cifar --config
      ../conf/afr.yaml --data_file power.csv --output_folder cifar/ --output_file
      merged.csv
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: data/bit_depth/cifar/power.csv
      hash: md5
      md5: b9ebbe01b2bd93f1c4af02fb8abd910b
      size: 5291011
    - path: data/cifar/power.csv
      hash: md5
      md5: a8e056a8c4008ce37006237f2e44b2bf
      size: 9997291
    params:
      ../conf/clean.yaml:
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
    outs:
    - path: cifar/merged.csv
      hash: md5
      md5: 2d2cbcb913a61d304950c910bd487b9b
      size: 15304603
  clean@cifar:
    cmd: python -m deckard.layers.clean_data --i cifar/merged.csv --o cifar/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: cifar/merged.csv
      hash: md5
      md5: 2d2cbcb913a61d304950c910bd487b9b
      size: 15304603
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: cifar/clean.csv
      hash: md5
      md5: c546fa08ebcc159fd81fcaa5dda11411
      size: 9305692
  afr@cifar:
    cmd: python -m deckard.layers.afr --dataset cifar --data_file cifar/clean.csv
      --config_file "../conf/afr.yaml" --plots_folder cifar/ --target adv_failures
      --duration_col adv_fit_time
    deps:
    - path: ../conf/afr.yaml
      hash: md5
      md5: 061aa289da159a323139555e472391da
      size: 5666
    - path: cifar/clean.csv
      hash: md5
      md5: c546fa08ebcc159fd81fcaa5dda11411
      size: 9305692
    outs:
    - path: cifar/aft_comparison.csv
      hash: md5
      md5: 11751a71d62d6c7eceed779537b20a3b
      size: 266
    - path: cifar/aft_comparison.tex
      hash: md5
      md5: e8bd848301a3769eb655267f6b66584e
      size: 536
    - path: cifar/cox_aft.pdf
      hash: md5
      md5: f355820940b7b332629d5c85ec344c9c
      size: 22623
    - path: cifar/cox_epochs_partial_effect.pdf
      hash: md5
      md5: 6dbc96d27e2a6028ad3a7f9b5c55ecf0
      size: 26815
    - path: cifar/log_logistic_aft.pdf
      hash: md5
      md5: 5e075e64dd770cecb790f279c671e324
      size: 22841
    - path: cifar/log_logistic_epochs_partial_effect.pdf
      hash: md5
      md5: cb9e96974f9613929e681dfd3a9cf080
      size: 25011
    - path: cifar/log_normal_aft.pdf
      hash: md5
      md5: d175561d0772cf1287499dbb4cc2e0aa
      size: 22877
    - path: cifar/log_normal_epochs_partial_effect.pdf
      hash: md5
      md5: 7ca6c59cfba576b02b166a935e6e3cde
      size: 25594
    - path: cifar/weibull_aft.pdf
      hash: md5
      md5: 622c2b11fdc8235039e9369ef6214891
      size: 22972
    - path: cifar/weibull_epochs_partial_effect.pdf
      hash: md5
      md5: afecda1575d1f87cc7a1ae378fb42916
      size: 24538
  merge@cifar100:
    cmd: python merge.py  --big_dir data/bit_depth/cifar100 --little_dir data/cifar100
      --config ../conf/afr.yaml --data_file power.csv --output_folder cifar100/ --output_file
      merged.csv
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: data/bit_depth/cifar100/power.csv
      hash: md5
      md5: d52080413e3ba7bd86ef8d92ebd00507
      size: 3987447
    - path: data/cifar100/power.csv
      hash: md5
      md5: f51f0d4ebd105f64829af90a0212de00
      size: 16081846
    params:
      ../conf/clean.yaml:
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
    outs:
    - path: cifar100/merged.csv
      hash: md5
      md5: f2bf33451a3c6a27e8b37dafc2a30ace
      size: 20099761
  clean@cifar100:
    cmd: python -m deckard.layers.clean_data --i cifar100/merged.csv --o cifar100/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: cifar100/merged.csv
      hash: md5
      md5: f2bf33451a3c6a27e8b37dafc2a30ace
      size: 20099761
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: cifar100/clean.csv
      hash: md5
      md5: d020a3f4406f0f6091ea8f09ea67b824
      size: 9318360
  afr@cifar100:
    cmd: python -m deckard.layers.afr --dataset cifar100 --data_file cifar100/clean.csv
      --config_file "../conf/afr.yaml" --plots_folder cifar100/ --target adv_failures
      --duration_col adv_fit_time
    deps:
    - path: ../conf/afr.yaml
      hash: md5
      md5: 061aa289da159a323139555e472391da
      size: 5666
    - path: cifar100/clean.csv
      hash: md5
      md5: d020a3f4406f0f6091ea8f09ea67b824
      size: 9318360
    outs:
    - path: cifar100/aft_comparison.csv
      hash: md5
      md5: 2a5187500f67a2d6eec01726376eac34
      size: 262
    - path: cifar100/aft_comparison.tex
      hash: md5
      md5: 01965140c4b468981caa0d4591084ef7
      size: 535
    - path: cifar100/cox_aft.pdf
      hash: md5
      md5: f2c59fc263a58929525e16c0f5cf5113
      size: 22596
    - path: cifar100/cox_epochs_partial_effect.pdf
      hash: md5
      md5: fed9f72d6fd761ef106780f4205f5c7a
      size: 29741
    - path: cifar100/log_logistic_aft.pdf
      hash: md5
      md5: d3f5daf953b08d4dae98ddb7e377c862
      size: 22542
    - path: cifar100/log_logistic_epochs_partial_effect.pdf
      hash: md5
      md5: 726bb1b86ce02367818302e1b3aa2aba
      size: 24827
    - path: cifar100/log_normal_aft.pdf
      hash: md5
      md5: 7ed6f858ce5be7f06ce739454803043f
      size: 22865
    - path: cifar100/log_normal_epochs_partial_effect.pdf
      hash: md5
      md5: 8f6a40a63b2efc0a6e57c34bacc0171f
      size: 25516
    - path: cifar100/weibull_aft.pdf
      hash: md5
      md5: 66bb37e2fd7df904df6f7af0414c3a70
      size: 22989
    - path: cifar100/weibull_epochs_partial_effect.pdf
      hash: md5
      md5: 479734e8c927b90242b0123e3a3cf877
      size: 24305
  combined_plots:
    cmd: python combined_plots.py
    deps:
    - path: cifar/aft_comparison.csv
      hash: md5
      md5: 11751a71d62d6c7eceed779537b20a3b
      size: 266
    - path: cifar100/aft_comparison.csv
      hash: md5
      md5: 2a5187500f67a2d6eec01726376eac34
      size: 262
    - path: combined_plots.py
      hash: md5
      md5: 9b0bec1a5faf2d1965895d1e88887cdc
      size: 9011
    - path: mnist/aft_comparison.csv
      hash: md5
      md5: f6e0ce8c6d214014261fb52b1566ce1c
      size: 263
    outs:
    - path: combined/acc.pdf
      hash: md5
      md5: ad0bf8b0a66f563a62a204b20710fe12
      size: 27363
    - path: combined/cost.pdf
      hash: md5
      md5: 442b0233c4904a360f2d5da35e41a299
      size: 43068
    - path: combined/power.pdf
      hash: md5
      md5: 50d4009eeb2e74b69fdc6a1bb9d1f105
      size: 42356
    - path: combined/time.pdf
      hash: md5
      md5: e422313ce49fbe7a071935709ab6da79
      size: 42366
    - path: data/combined/combined.csv
      hash: md5
      md5: 5373a0cba09196ebf00bbfbab9378398
      size: 52639498
  combined_clean:
    cmd: python -m deckard.layers.clean_data --i data/combined/combined.csv --o combined/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: data/combined/combined.csv
      hash: md5
      md5: 5373a0cba09196ebf00bbfbab9378398
      size: 52639498
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: combined/clean.csv
      hash: md5
      md5: 15c348d9d5a89c9637e80062dc0af99a
      size: 37267652
  combined_afr:
    cmd: python -m deckard.layers.afr --dataset Combined --data_file combined/clean.csv
      --config_file "../conf/combined_afr.yaml" --plots_folder combined/ --target
      adv_failures --duration_col adv_fit_time
    deps:
    - path: ../conf/combined_afr.yaml
      hash: md5
      md5: 203dfa79cb6b3eb6ebd79fa4cbf562cd
      size: 4975
    - path: combined/clean.csv
      hash: md5
      md5: 15c348d9d5a89c9637e80062dc0af99a
      size: 37267652
    outs:
    - path: combined/aft_comparison.csv
      hash: md5
      md5: d02089bb218d16ba7de45125669a7b23
      size: 271
    - path: combined/aft_comparison.tex
      hash: md5
      md5: 5f35183b101579959f517e6da4299e53
      size: 542
    - path: combined/log_logistic_aft.pdf
      hash: md5
      md5: a68b31e34d1ab8813f8f71fddf987398
      size: 28656
    - path: combined/log_logistic_qq.pdf
      hash: md5
      md5: d5b820084d1f3f19981c50ee0cd0e0fc
      size: 17236
    - path: combined/log_logistic_summary.csv
      hash: md5
      md5: f5291c939b61e9fd768265d804a47e95
      size: 3401
    - path: combined/log_normal_aft.pdf
      hash: md5
      md5: cfbc75317664bbecf62172672a3944c8
      size: 28815
    - path: combined/log_normal_qq.pdf
      hash: md5
      md5: 29686d8d216d439e6b66af43b6512b81
      size: 18768
    - path: combined/log_normal_summary.csv
      hash: md5
      md5: cdc94cc5f4399c2cf4897035d26b745d
      size: 3370
    - path: combined/weibull_aft.pdf
      hash: md5
      md5: 7d9437912312ece4ba052b4c32b96bd7
      size: 28811
    - path: combined/weibull_qq.pdf
      hash: md5
      md5: 91e855aa3571fdf066ece6f4f04ec908
      size: 16977
    - path: combined/weibull_summary.csv
      hash: md5
      md5: 57816c0c1036b75a65a6cd618d550e49
      size: 3416
  predict_survival_time@weibull:
    cmd: python predict_with_best.py  --data combined/clean.csv  --config_file ../conf/combined_afr.yaml  --model
      weibull --target adv_failures  --duration_col adv_fit_time --output combined/weibull.csv
    deps:
    - path: ../conf/combined_afr.yaml
      hash: md5
      md5: 203dfa79cb6b3eb6ebd79fa4cbf562cd
      size: 4975
    - path: combined/aft_comparison.tex
      hash: md5
      md5: 5f35183b101579959f517e6da4299e53
      size: 542
    - path: combined/clean.csv
      hash: md5
      md5: 15c348d9d5a89c9637e80062dc0af99a
      size: 37267652
    - path: predict_with_best.py
      hash: md5
      md5: 178074244d30f7eecf7c1eae65d8ffa9
      size: 2557
    outs:
    - path: combined/weibull.csv
      hash: md5
      md5: 90709af7e1358d4463a19c5f891e79fd
      size: 37565381
  predict_survival_time@log_normal:
    cmd: python predict_with_best.py  --data combined/clean.csv  --config_file ../conf/combined_afr.yaml  --model
      log_normal --target adv_failures  --duration_col adv_fit_time --output combined/log_normal.csv
    deps:
    - path: ../conf/combined_afr.yaml
      hash: md5
      md5: 203dfa79cb6b3eb6ebd79fa4cbf562cd
      size: 4975
    - path: combined/aft_comparison.tex
      hash: md5
      md5: 5f35183b101579959f517e6da4299e53
      size: 542
    - path: combined/clean.csv
      hash: md5
      md5: 15c348d9d5a89c9637e80062dc0af99a
      size: 37267652
    - path: predict_with_best.py
      hash: md5
      md5: 178074244d30f7eecf7c1eae65d8ffa9
      size: 2557
    outs:
    - path: combined/log_normal.csv
      hash: md5
      md5: ce71a51047d24c93af4f5df60bf4cc43
      size: 37565362
  predict_survival_time@log_logistic:
    cmd: python predict_with_best.py  --data combined/clean.csv  --config_file ../conf/combined_afr.yaml  --model
      log_logistic --target adv_failures  --duration_col adv_fit_time --output combined/log_logistic.csv
    deps:
    - path: ../conf/combined_afr.yaml
      hash: md5
      md5: 203dfa79cb6b3eb6ebd79fa4cbf562cd
      size: 4975
    - path: combined/aft_comparison.tex
      hash: md5
      md5: 5f35183b101579959f517e6da4299e53
      size: 542
    - path: combined/clean.csv
      hash: md5
      md5: 15c348d9d5a89c9637e80062dc0af99a
      size: 37267652
    - path: predict_with_best.py
      hash: md5
      md5: 178074244d30f7eecf7c1eae65d8ffa9
      size: 2557
    outs:
    - path: combined/log_logistic.csv
      hash: md5
      md5: 6b4842aae2a8bd7ab52307b67e9d3eed
      size: 37565421
  plot_trash_score@weibull:
    cmd: python plot_trash_score.py  --input_file combined/weibull.csv  --output_file
      combined/weibull_trash_score.pdf --title weibull
    deps:
    - path: combined/weibull.csv
      hash: md5
      md5: 90709af7e1358d4463a19c5f891e79fd
      size: 37565381
    - path: plot_trash_score.py
      hash: md5
      md5: f3a0939b9d45d6d1759f8aad1e143f27
      size: 1634
    outs:
    - path: combined/weibull_trash_score.pdf
      hash: md5
      md5: 553f136f23d851f8e6c086c2a089fda8
      size: 22242
  plot_trash_score@log_normal:
    cmd: python plot_trash_score.py  --input_file combined/log_normal.csv  --output_file
      combined/log_normal_trash_score.pdf --title log_normal
    deps:
    - path: combined/log_normal.csv
      hash: md5
      md5: ce71a51047d24c93af4f5df60bf4cc43
      size: 37565362
    - path: plot_trash_score.py
      hash: md5
      md5: f3a0939b9d45d6d1759f8aad1e143f27
      size: 1634
    outs:
    - path: combined/log_normal_trash_score.pdf
      hash: md5
      md5: 0fd9336e45778cd3d18afe319b3b77bf
      size: 22724
  plot_trash_score@log_logistic:
    cmd: python plot_trash_score.py  --input_file combined/log_logistic.csv  --output_file
      combined/log_logistic_trash_score.pdf --title log_logistic
    deps:
    - path: combined/log_logistic.csv
      hash: md5
      md5: 6b4842aae2a8bd7ab52307b67e9d3eed
      size: 37565421
    - path: plot_trash_score.py
      hash: md5
      md5: f3a0939b9d45d6d1759f8aad1e143f27
      size: 1634
    outs:
    - path: combined/log_logistic_trash_score.pdf
      hash: md5
      md5: 53bfaba2e90cf6326f77b55f6886ec18
      size: 22023
  copy@cifar100:
    cmd: rm -rf ../plots/cifar100/ && mkdir -p ../plots/cifar100/ && cp -r cifar100/*.pdf
      cifar100/*.csv cifar100/*.tex ../plots/cifar100/
    deps:
    - path: cifar100/
      hash: md5
      md5: 93fb0bab65317000f4145769410a629a.dir
      size: 29695303
      nfiles: 21
  copy@mnist:
    cmd: rm -rf ../plots/mnist/ && mkdir -p ../plots/mnist/ && cp -r mnist/*.pdf mnist/*.csv
      mnist/*.tex ../plots/mnist/
    deps:
    - path: mnist/
      hash: md5
      md5: c91397e60ec588583aa5b4044845d8e9.dir
      size: 24978381
      nfiles: 21
  copy@cifar:
    cmd: rm -rf ../plots/cifar/ && mkdir -p ../plots/cifar/ && cp -r cifar/*.pdf cifar/*.csv
      cifar/*.tex ../plots/cifar/
    deps:
    - path: cifar/
      hash: md5
      md5: aed80417a31cf64b16995bf2711009de.dir
      size: 24885292
      nfiles: 21
  copy@combined:
    cmd: rm -rf ../plots/combined/ && mkdir -p ../plots/combined/ && cp -r combined/*.pdf
      combined/*.csv combined/*.tex ../plots/combined/
    deps:
    - path: combined/
      hash: md5
      md5: abaa27b43eae1e0be39cb97cc2ace4cb.dir
      size: 150471370
      nfiles: 29
